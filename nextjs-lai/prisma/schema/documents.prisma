model Document {
  id              String   @id @default(cuid())
  title           String
  fileName        String?
  fileType        String
  fileSize        Int?
  content         String
  subject         String?
  tags            String[] @default([])
  summary         String?
  tableOfContents Json?    // Stored as JSON array of TOC sections
  createdAt       DateTime @default(now())
  updatedAt       DateTime @updatedAt

  chunks       DocumentChunk[]
  chatSessions ChatSession[]
  quizzes      Quiz[]
  flashcards   Flashcard[]
  topics       Topic[]
}

model DocumentChunk {
  id         String @id @default(cuid())
  documentId String
  content    String
  chunkIndex Int
  pageNumber Int?
  tokenCount Int?
  embedding  Unsupported("vector(768)")?

  document      Document       @relation(fields: [documentId], references: [id], onDelete: Cascade)
  quizQuestions QuizQuestion[]
  flashcards    Flashcard[]

  @@index([documentId])
}

model Topic {
  id          String   @id @default(cuid())
  documentId  String
  name        String
  description String?
  chunkIds    String[] @default([])
  createdAt   DateTime @default(now())

  document Document @relation(fields: [documentId], references: [id], onDelete: Cascade)

  @@index([documentId])
}
