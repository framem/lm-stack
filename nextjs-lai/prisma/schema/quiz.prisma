model Quiz {
  id         String   @id @default(cuid())
  title      String
  documentId String
  createdAt  DateTime @default(now())

  document  Document       @relation(fields: [documentId], references: [id], onDelete: Cascade)
  questions QuizQuestion[]

  @@index([documentId])
}

model QuizQuestion {
  id            String  @id @default(cuid())
  quizId        String
  questionText  String
  options       Json
  correctIndex  Int
  explanation   String?
  sourceChunkId String?
  sourceSnippet String?
  questionIndex Int

  quiz         Quiz          @relation(fields: [quizId], references: [id], onDelete: Cascade)
  sourceChunk  DocumentChunk? @relation(fields: [sourceChunkId], references: [id], onDelete: SetNull)
  attempts     QuizAttempt[]

  @@index([quizId])
}

model QuizAttempt {
  id            String   @id @default(cuid())
  questionId    String
  selectedIndex Int
  isCorrect     Boolean
  explanation   String?
  createdAt     DateTime @default(now())

  question QuizQuestion @relation(fields: [questionId], references: [id], onDelete: Cascade)

  @@index([questionId])
}
